<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="kr.co.wheelingcamp.item.model.mapper.ItemMapper">

		<!--package 한 개 가져오기 resultMap-->
		<resultMap type="Package" id="package_rm">
				<!-- id 태그 : PK 역할을 하는 컬럼, 필드를 작성하는 태그 -->
				<id property="packageNo" column="PACKAGE_NO" />
				<!-- collection 태그
					select로 조회된 결과를 컬렉션(List)에 담아
					지정된 필드에 세팅
					
					property : List를 담을 DTO의 필드명
					select : 실행할 select의 id
					column : 조회 결과 중 지정된 컬럼의 값을 파라미터로 전달
					javaType : List(컬렉션)의 타입을 지정
					ofType : List(컬렉션)의 제네릭(타입 제한) 지정
					-->
			<!--  해당 게시글 이미지 목록 조회 후 필드에 저장  -->
				<collection 
					property="itemList"
					select = "selectOnePackageItemList"
					column = "ITEM_NO"
					javaType="java.util.ArrayList"
					ofType = "Item"
				/>

		</resultMap>


	<!--차 한 대 가져오기-->
	<select id="selectOneCar" resultType="Car">
		SELECT ITEM_NO, CAR_NAME, CAR_FUEL, CAR_GRADE_NAME,
		CAR_PASSENGERS, CAR_SLEEP_CAPACITY, CAR_RENT_PRICE,
		ITEM_VIEW_COUNT, 	
		(SELECT IMG_PATH || IMG_RENAME
			 FROM ITEM_IMG
			 WHERE ITEM_NO =#{itemNo}
			 AND   IMG_ORDER = 0) THUMBNAIL
		FROM CAR NATURAL JOIN ITEM 
		NATURAL JOIN CAR_GRADE
		WHERE ITEM_NO = #{itemNo}
	</select>

	<!--캠핑 용품 한 개 가져오기-->
	<select id="selectOneEquipment">
		SELECT EQUIPMENT_NAME, EQUIPMENT_RENT_PRICE, ITEM_VIEW_COUNT, EQUIPMENT_SELL_PRICE , EQUIPMENT_CATEGORY_NAME
		FROM CAMP_EQUIPMENT 
		NATURAL JOIN ITEM 
		NATURAL JOIN EQUIPMENT_CATEGORY 
		WHERE ITEM_NO = #{itemNo}
	</select>

<!--	패키지 한 개 가져오기
	<select id="selectOnePackage" resultMap="package_rm">
		SELECT PACKAGE_PRICE, PACKAGE_ITEM_COUNT FROM "PACKAGE" 
		NATURAL JOIN PACKAGE_DETAIL WHERE PACKAGE_NO = #{itemNo}
	</select>

	<select id="selectOnePackageItemList" resultType="Item">
		SELECT EQUIPMENT_NAME, EQUIPMENT_CATEGORY_NAME, EQUIPMENT_RENT_PRICE FROM CAMP_EQUIPMENT
		NATURAL_JOIN ITEM A
		NATURAL JOIN EQUIPMENT_CATEGORY
		LEFT JOIN PACKAGE ON (A.ITEM_NO = PACKAGE_NO)
		WHERE PACKAGE
	</select>-->
	
	<!-- 모든 자동차 목록 탐색 -->
	<select id="selectCarAll">
		SELECT ITEM_NO, CAR_NAME 
		FROM CAR
	</select>

<!--	 
모든 캠핑용품 목록 탐색 
	<select id="selectCampEquipmentAll">
		
	</select>
	
	 모든 패키지 목록 탐색 
	<select id="selectPackageAll">
	
	</select>
	-->

</mapper>
